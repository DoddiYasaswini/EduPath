<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduPath Pro | Secure Career Roadmap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #f8fafc; }
        .glass-card { background: white; border-radius: 1.5rem; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .hidden { display: none; }
        .step-line { border-left: 3px dashed #cbd5e1; margin-left: 1.25rem; padding-left: 2rem; position: relative; }
        .step-dot { position: absolute; left: -0.65rem; top: 0; width: 1.25rem; height: 1.25rem; background: #4f46e5; border-radius: 50%; border: 3px solid white; }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div id="app" class="max-w-4xl mx-auto">
        <div id="auth-section" class="glass-card p-10 text-center shadow-xl">
            <h1 class="text-3xl font-bold text-indigo-600 mb-6 text-center">EduPath AI Roadmap ðŸš€</h1>
            <button onclick="loginWithGoogle()" class="flex items-center gap-3 mx-auto border px-8 py-3 rounded-xl hover:bg-gray-50 font-medium">
                <img src="https://www.gstatic.com/images/branding/product/1x/gsa_512dp.png" class="w-6"> Login with Google
            </button>
        </div>

        <div id="quiz-section" class="hidden glass-card overflow-hidden">
            <div class="bg-indigo-600 p-6 text-white flex justify-between items-center">
                <h2 class="font-bold">Career Discovery Quiz</h2>
                <button onclick="logout()" class="text-xs bg-indigo-500 px-3 py-1 rounded-lg">Logout</button>
            </div>
            <div class="p-8">
                <div id="question-container">
                    <h3 id="question-text" class="text-xl font-bold mb-6 text-indigo-600"></h3>
                    <div id="options-container" class="grid gap-3"></div>
                </div>
                <div class="mt-8 flex justify-end">
                    <button id="nextBtn" onclick="nextQuestion()" class="hidden bg-indigo-600 text-white px-8 py-2 rounded-xl font-bold">Next</button>
                </div>
            </div>
        </div>

        <div id="result-section" class="hidden space-y-8">
            <div class="glass-card p-8">
                <div class="flex justify-between items-center mb-8 border-b pb-4">
                    <h2 id="spec-name" class="text-3xl font-bold text-indigo-600"></h2>
                    <button onclick="downloadPDF()" class="bg-green-600 text-white px-6 py-2 rounded-lg font-bold">Download PDF</button>
                </div>
                
                <div id="stats-grid" class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"></div>
                
                <div id="pdf-content">
                    <h3 class="text-2xl font-bold mb-6">Mastery Roadmap (6 Levels)</h3>
                    <div id="levels-list" class="space-y-4"></div>
                </div>

                <button onclick="location.reload()" class="w-full mt-10 text-gray-400 underline font-bold italic text-center block">Start Over</button>
            </div>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "PASTE_YOUR_NEW_API_KEY_HERE",
            authDomain: "edupath-5a9f8.firebaseapp.com",
            projectId: "edupath-5a9f8",
            storageBucket: "edupath-5a9f8.firebasestorage.app",
            messagingSenderId: "203481102798",
            appId: "1:203481102798:web:952f93771195ff16afd39f"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        const quizData = [
            { q: "Current Engineering Branch?", key: "branch", options: ["CSE/IT", "ECE/EEE", "Mechanical", "Civil"] },
            { q: "What interests you the most?", key: "interest", options: ["Software Development", "Data Science & AI", "Cyber Security", "Ethical Hacking"] }
        ];

        const knowledgeBase = {
            "Software Development": {
                name: "Software Developer",
                stats: { high: "65 LPA", avg: "12 LPA", least: "4 LPA" },
                levels: [
                    { t: "L1: Foundations", d: "C++/Java/Python syntax.", time: "4 Weeks" },
                    { t: "L2: DSA", d: "Arrays, Sorting, Trees.", time: "8 Weeks" },
                    { t: "L3: Development", d: "HTML/CSS & React.js.", time: "6 Weeks" },
                    { t: "L4: Database", d: "SQL & REST APIs.", time: "4 Weeks" },
                    { t: "L5: System Design", d: "Scalability patterns.", time: "5 Weeks" },
                    { t: "L6: DevOps", d: "Docker & AWS.", time: "4 Weeks" }
                ]
            },
            "Ethical Hacking": {
                name: "Cyber Security Specialist",
                stats: { high: "42 LPA", avg: "10 LPA", least: "4.5 LPA" },
                levels: [
                    { t: "L1: Networking", d: "TCP/IP & OSI Model.", time: "4 Weeks" },
                    { t: "L2: Linux", d: "Terminal & BASH Mastery.", time: "3 Weeks" },
                    { t: "L3: Recon", d: "Nmap & Info Gathering.", time: "3 Weeks" },
                    { t: "L4: Web Pentesting", d: "SQLi & OWASP Top 10.", time: "6 Weeks" },
                    { t: "L5: Exploitation", d: "Metasploit & Burp Suite.", time: "6 Weeks" },
                    { t: "L6: Reporting", d: "Professional Report Writing.", time: "3 Weeks" }
                ]
            }
        };

        let currentIdx = 0, answers = {};

        auth.onAuthStateChanged(user => {
            if (user) {
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('quiz-section').classList.remove('hidden');
                showQuestion();
                db.collection("users").doc(user.uid).set({ name: user.displayName, email: user.email }, { merge: true });
            } else {
                document.getElementById('auth-section').classList.remove('hidden');
                document.getElementById('quiz-section').classList.add('hidden');
            }
        });

        function loginWithGoogle() { auth.signInWithPopup(new firebase.auth.GoogleAuthProvider()); }
        function logout() { auth.signOut(); }

        function showQuestion() {
            const q = quizData[currentIdx];
            document.getElementById('question-text').innerText = q.q;
            const container = document.getElementById('options-container');
            container.innerHTML = "";
            q.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full p-4 border rounded-xl text-left hover:bg-indigo-50 transition";
                btn.innerText = opt;
                btn.onclick = () => selectOption(q.key, opt, btn);
                container.appendChild(btn);
            });
        }

        function selectOption(key, val, btn) {
            answers[key] = val;
            document.querySelectorAll('#options-container button').forEach(b => b.classList.remove('bg-indigo-100', 'border-indigo-600'));
            btn.classList.add('bg-indigo-100', 'border-indigo-600');
            document.getElementById('nextBtn').classList.remove('hidden');
        }

        function nextQuestion() {
            if (currentIdx < quizData.length - 1) {
                currentIdx++;
                document.getElementById('nextBtn').classList.add('hidden');
                showQuestion();
            } else {
                displayResult();
            }
        }

        function displayResult() {
            const info = knowledgeBase[answers.interest] || knowledgeBase["Software Development"];
            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            document.getElementById('spec-name').innerText = info.name;
            
            document.getElementById('stats-grid').innerHTML = `
                <div class="p-6 bg-green-50 rounded-2xl"><p class="text-xs font-bold text-green-600 uppercase">Highest</p><h3 class="text-2xl font-black">${info.stats.high}</h3></div>
                <div class="p-6 bg-blue-50 rounded-2xl"><p class="text-xs font-bold text-blue-600 uppercase">Average</p><h3 class="text-2xl font-black">${info.stats.avg}</h3></div>
                <div class="p-6 bg-red-50 rounded-2xl"><p class="text-xs font-bold text-red-600 uppercase">Lowest</p><h3 class="text-2xl font-black">${info.stats.least}</h3></div>
            `;

            document.getElementById('levels-list').innerHTML = info.levels.map(l => `
                <div class="step-line">
                    <div class="step-dot"></div>
                    <p class="text-indigo-600 font-bold text-xs uppercase tracking-widest">${l.time} Est.</p>
                    <h4 class="text-lg font-bold text-slate-800">${l.t}</h4>
                    <p class="text-sm text-slate-500">${l.d}</p>
                </div>
            `).join('');
        }

        async function downloadPDF() {
            const element = document.getElementById('pdf-content');
            const canvas = await html2canvas(element);
            const imgData = canvas.toDataURL('image/png');
            const pdf = new jspdf.jsPDF();
            pdf.addImage(imgData, 'PNG', 10, 10, 190, (canvas.height * 190) / canvas.width);
            pdf.save(`${auth.currentUser.displayName}_Roadmap.pdf`);
        }
    </script>
</body>
</html>
